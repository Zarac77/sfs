@model Sfs.ViewModels.AtividadeViewModels.GerarListaViewModel

@{
    ViewBag.Title = "GerarLista";
}
@if(true) {
    <form action="~/Atividade/GerarLista" method="get" id="listaQuery">
    <fieldset>
        <legend>
            Adicionar Inscrições
        </legend>
    
        <div class="row">
            <div class="large-3 columns">
            Matrícula
            <input type="text" name="Matricula" id="Matricula" value="@Model.Matricula"/>
            </div>
        
            <div class="large-3 columns">
            Turma
            <input type="text" name="Turma" id="Turma" value="@Model.Turma"/>
            </div>
            <div class="large-2 columns">
                <br />
                @SfsHtml.Submit("Pesquisar")

            </div>
            <div class="large-4 columns"></div>
        </div>
    </fieldset>
        <input type="hidden" name="IdAtividade" value="@Model.IdAtividade" />
    </form>
    <br />
    <form action="~/Atividade/ForcarInscricoes" method="post">
        @{
        var c = 0;
        }
    @if (Model.ResultadoPessoas != null)
    {
        @SfsHtml.SelecionarTodosTrigger("listaQuery") <text><b>Selecionar Todos</b></text>
        <br />
        foreach (var p in Model.ResultadoPessoas)
        {
            <input type="checkbox" name="IdSelecionados" class="listaQuery" value="@p.Id"/> @p.Nome
            <br />
            c++;
        }
        @SfsHtml.Submit("Adicionar")
    }
    
        <input type="hidden" name="IdAtividade" value="@Model.IdAtividade" />
        <input type="hidden" name="CampoMatricula" value="@Model.Matricula" />
        <input type="hidden" name="CampoTurma" value="@Model.Turma" />
    </form>
}

@{
    var lmodel = Model._ListarViewModel;
}
<form id="listaAtividade" action="~/Atividade/RedirectToListarAction" method="post">
    @Html.Partial("_Listar", lmodel)
</form>
@if (ViewBag.PessoaLogada.IsAdministrador) {
    <p style="text-align:right">
        <input type="button" class="small alert button" value="Desafixar" onclick="redirect('DesafixarInscricoes')" />
        <input type="button" class="small success button" value="Fixar" onclick="redirect('FixarInscricoes')" />
        <input type="button" class="small alert button" value="Cancelar Inscrições" onclick="redirect('CancelarInscricoes')" />
    </p>
}
<script>
    function redirect(sender) {
        $('#listaAtividade').get(0).setAttribute('action', sender);
        $('#listaAtividade').submit();
    }
</script>
@SfsHtml.SelecionarTodosScript()
